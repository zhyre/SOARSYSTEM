{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOAR - Organization Management</title>
    <link rel="stylesheet" href="{% static 'accounts/organization.css' %}">
    <link rel="stylesheet" href="{% static 'accounts/profile.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="{% static 'js/organization/sidebar.js' %}" defer></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Enhanced Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #3b82f6, #2563eb);
            border-radius: 5px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(180deg, #2563eb, #1d4ed8);
        }

        /* Glass Morphism Effects */
        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }

        .glass-input {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .glass-input:focus {
            background: rgba(255, 255, 255, 1);
            transform: translateY(-2px);
            box-shadow: 0 10px 30px -10px rgba(59, 130, 246, 0.3);
        }

        /* Gradient Animations */
        @keyframes gradient-shift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .animated-gradient {
            background-size: 200% 200%;
            animation: gradient-shift 8s ease infinite;
        }

        /* Shimmer Effect */
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .shimmer-effect {
            position: relative;
            overflow: hidden;
        }

        .shimmer-effect::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transform: translateX(-100%);
        }

        .shimmer-effect:hover::after {
            animation: shimmer 1.5s ease-in-out;
        }

        /* Fade In Animation */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in-up {
            animation: fadeInUp 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }

        /* Stagger Animation */
        .stagger-1 { animation-delay: 0.1s; }
        .stagger-2 { animation-delay: 0.2s; }
        .stagger-3 { animation-delay: 0.3s; }
        .stagger-4 { animation-delay: 0.4s; }

        /* Button Hover Effects */
        .btn-primary {
            position: relative;
            overflow: hidden;
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .btn-primary::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn-primary:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 20px 40px -15px rgba(59, 130, 246, 0.5);
        }

        /* Chip Effects */
        .program-chip {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .program-chip::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transition: left 0.5s;
        }

        .program-chip:hover::before {
            left: 100%;
        }

        .program-chip:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 10px 25px -5px rgba(59, 130, 246, 0.3);
        }

        /* File Upload Enhancement */
        .file-upload-area {
            transition: all 0.3s ease;
            position: relative;
        }

        .file-upload-area:hover {
            transform: scale(1.02);
            box-shadow: 0 15px 35px -10px rgba(59, 130, 246, 0.2);
        }

        /* Success/Error Messages */
        .message-box {
            animation: slideInDown 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes slideInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Profile Picture Enhancement */
        .profile-pic-wrapper {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .profile-pic-wrapper:hover {
            transform: scale(1.08) rotate(5deg);
        }

        .profile-pic-badge {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        @keyframes pulse {
            0%, 100% {
                opacity: 1;
                transform: scale(1);
            }
            50% {
                opacity: 0.8;
                transform: scale(1.1);
            }
        }

        /* Enhanced Border Gradient */
        .border-gradient {
            position: relative;
            background: white;
            border-radius: 1rem;
        }

        .border-gradient::before {
            content: '';
            position: absolute;
            inset: -2px;
            border-radius: 1rem;
            padding: 2px;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6, #ec4899);
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .border-gradient:hover::before {
            opacity: 1;
        }

        /* Mobile Sidebar Styles */
        .sidebar {
            transform: translateX(0);
            transition: transform 0.3s ease-in-out;
        }

        .sidebar.mobile-open {
            transform: translateX(0);
        }

        @media (max-width: 768px) {
            .sidebar {
                position: fixed;
                top: 0;
                left: 0;
                height: 100vh;
                z-index: 50;
                transform: translateX(-100%);
            }

            .sidebar.mobile-open {
                transform: translateX(0);
            }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-gray-50 via-blue-50 to-indigo-50 animated-gradient">
    {% if can_edit %}
    <div id="overlay" class="hidden fixed inset-0 bg-black bg-opacity-50 z-40 md:hidden"></div>

    <div class="flex h-screen overflow-hidden">
        <!-- Sidebar -->
        <div class="sidebar flex h-screen overflow-hidden">
            {% if organization %}
            {% include 'base/sidebar_components.html' with sidebar_type='organization' %}
            {% endif %}
        </div>
        <!-- Main Content -->
        <div class="flex-1 flex flex-col overflow-hidden">
            <!-- Top Bar -->
            <header class="glass-card shadow-lg z-10 border-b border-blue-200">
                <div class="flex items-center justify-between px-6 py-4">
                    <div class="flex items-center space-x-4">
                        <!-- Mobile Menu Toggle -->
                        <button id="mobileMenuToggle" class="md:hidden p-2 rounded-lg text-gray-600 hover:bg-gray-100 transition-colors">
                            <i class="fas fa-bars text-xl"></i>
                        </button>
                        
                        <div>
                            <h1 class="text-2xl font-bold text-gray-800 flex items-center">
                                <i class="fas fa-cog text-blue-600 mr-3"></i>
                                Organization Profile
                            </h1>
                        </div>
                    </div>

                    <!-- Top Right Buttons -->
                    <div class="flex items-center gap-3">
                        <a href="{% url 'membermanagement' organization.id%}" 
                           class="hidden sm:flex items-center space-x-2 px-5 py-2.5 bg-gradient-to-r from-green-600 to-green-700 text-white rounded-lg hover:from-green-700 hover:to-green-800 transition-all duration-200 shadow-md hover:shadow-lg font-medium shimmer-effect hover:scale-105">
                            <i class="fas fa-users-cog"></i>
                            <span>Member Management</span>
                        </a>
                        
                        <!-- Mobile Dropdown -->
                        <div class="sm:hidden relative">
                            <button id="mobileActionsBtn" class="p-2 hover:bg-gray-100 rounded-lg transition-colors">
                                <i class="fas fa-ellipsis-v text-gray-600"></i>
                            </button>
                            <div id="mobileActionsMenu" class="hidden absolute right-0 mt-2 w-56 bg-white rounded-lg shadow-lg border border-gray-200 py-2">
                                <a href="{% url 'membermanagement' organization.id %}" class="flex items-center space-x-2 px-4 py-2 hover:bg-gray-100 transition-colors">
                                    <i class="fas fa-users-cog text-green-600"></i>
                                    <span>Member Management</span>
                                </a>
                            </div>
                        </div>

                        <!-- User Profile -->
                        <div class="flex items-center space-x-3 pl-3 border-l border-gray-200">
                            <div class="hidden md:block text-right">
                                <p class="text-sm font-medium text-gray-700">{{ user.last_name }}, {{ user.first_name }}{% if user.middle_name %} {{ user.middle_name }}{% endif %}</p>
                            </div>
                            <a href="{% url 'profile' %}">
                                <img src="https://ui-avatars.com/api/?name={{ user.username|urlencode }}&background=2563eb&color=fff" 
                                     alt="{{ user.last_name }}, {{ user.first_name }}" 
                                     class="w-10 h-10 rounded-full border-2 border-blue-500 shadow-md cursor-pointer hover:border-blue-600 transition hover:scale-110">
                            </a>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Content Area -->
            <main class="flex-1 overflow-y-auto p-6">
                <div class="max-w-5xl mx-auto">
                    <!-- Messages -->
                    {% if success %}
                    <div class="mb-6 glass-card border-l-4 border-green-500 text-green-700 px-6 py-4 rounded-lg shadow-lg message-box">
                        <div class="flex items-center">
                            <i class="fas fa-check-circle text-2xl mr-3"></i>
                            <div>
                                <p class="font-semibold">Success!</p>
                                <p class="text-sm">Changes saved successfully!</p>
                            </div>
                        </div>
                    </div>
                    {% endif %}

                    {% if error %}
                    <div class="mb-6 glass-card border-l-4 border-red-500 text-red-700 px-6 py-4 rounded-lg shadow-lg message-box">
                        <div class="flex items-center">
                            <i class="fas fa-exclamation-circle text-2xl mr-3"></i>
                            <div>
                                <p class="font-semibold">Error!</p>
                                <p class="text-sm">Error saving changes. Please try again.</p>
                            </div>
                        </div>
                    </div>
                    {% endif %}

                    <!-- Organization Content -->
                    <div class="glass-card rounded-2xl shadow-2xl border border-blue-200 fade-in-up" id="organization-details">
                        <div class="space-y-6">
                            <!-- Header Section -->
                            <div class="bg-gradient-to-r from-blue-600 via-blue-700 to-indigo-700 px-8 py-6 rounded-t-2xl relative overflow-hidden animated-gradient">
                                <div class="absolute inset-0 bg-black opacity-5"></div>
                                <div class="absolute inset-0" style="background-image: url('data:image/svg+xml,%3Csvg width=\'60\' height=\'60\' viewBox=\'0 0 60 60\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cg fill=\'none\' fill-rule=\'evenodd\'%3E%3Cg fill=\'%23ffffff\' fill-opacity=\'0.05\'%3E%3Cpath d=\'M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z\'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E');"></div>
                                <div class="relative">
                                    <h2 class="text-xl font-bold text-white flex items-center">
                                        <i class="fas fa-edit mr-3"></i>
                                        Edit Organization Profile
                                    </h2>
                                    <p class="text-blue-100 text-sm mt-1">Update your organization details and settings</p>
                                </div>
                            </div>

                            <div class="px-8 pb-8">
                                <!-- Profile Header -->
                                <div class="flex flex-col items-center text-center mb-8 -mt-12 fade-in-up stagger-1">
                                    <div class="relative profile-pic-wrapper">
                                        {% if organization.profile_picture %}
                                        <img src="{{ organization.profile_picture.url }}"
                                             alt="Organization Logo"
                                             class="w-32 h-32 rounded-full object-cover border-4 border-white shadow-2xl ring-4 ring-blue-200">
                                        {% else %}
                                        <img src="/static/images/default_org.png"
                                             alt="Organization Logo"
                                             class="w-32 h-32 rounded-full object-cover border-4 border-white shadow-2xl ring-4 ring-blue-200">
                                        {% endif %}
                                        <div class="absolute -bottom-2 -right-2 w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center shadow-lg profile-pic-badge">
                                            <i class="fas fa-camera text-white text-sm"></i>
                                        </div>
                                    </div>
                                    <h3 class="mt-4 text-2xl font-bold text-gray-800">{{ organization.name }}</h3>
                                    <p class="text-gray-600 text-sm mt-1 max-w-2xl">{{ organization.description|default:"Organization description goes here." }}</p>
                                </div>

                                <!-- Form Fields -->
                                <form class="space-y-8"
                                      id="organizationForm"
                                      method="POST"
                                      enctype="multipart/form-data"
                                      action="{% url 'organization_editprofile' organization.id %}">
                                    {% csrf_token %}

                                    <!-- Profile Picture Upload -->
                                    <div class="glass-card p-6 rounded-xl border border-blue-200 file-upload-area fade-in-up stagger-2">
                                        <label for="id_profile_picture" class="block text-sm font-semibold text-gray-700 mb-3 flex items-center">
                                            <i class="fas fa-image text-blue-600 mr-2"></i>
                                            Organization Logo
                                        </label>
                                        <div class="relative">
                                            <input type="file" id="id_profile_picture" name="profile_picture" accept="image/*" 
                                                   class="glass-input w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100">
                                        </div>
                                        <div id="file-info" class="mt-3 text-sm text-gray-600 hidden bg-blue-50 px-4 py-2 rounded-lg">
                                            <i class="fas fa-paperclip mr-2 text-blue-600"></i>
                                            <span id="file-name" class="font-medium"></span>
                                        </div>
                                        <p class="text-xs text-gray-500 mt-2 flex items-start">
                                            <i class="fas fa-info-circle mr-2 mt-0.5 text-blue-500"></i>
                                            <span>Recommended: Square image, at least 400x400px</span>
                                        </p>
                                    </div>

                                    <input type="hidden" id="selectedProgramsInput" name="allowed_programs" value="{% for program in organization.allowed_programs.all %}{{ program.id }}{% if not forloop.last %},{% endif %}{% endfor %}">

                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 fade-in-up stagger-3">
                                        <!-- Organization Name -->
                                        <div class="border-gradient">
                                            <label for="id_name" class="block text-sm font-semibold text-gray-700 mb-2 flex items-center">
                                                <i class="fas fa-building text-blue-600 mr-2"></i>
                                                Organization Name *
                                            </label>
                                            <input type="text" id="id_name" name="name" required
                                                   value="{{ organization.name }}"
                                                   placeholder="Enter organization name"
                                                   class="glass-input w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all hover:border-gray-400">
                                        </div>

                                        <!-- Visibility -->
                                        <div class="border-gradient">
                                            <label for="id_is_public" class="block text-sm font-semibold text-gray-700 mb-2 flex items-center">
                                                <i class="fas fa-eye text-blue-600 mr-2"></i>
                                                Visibility
                                            </label>
                                            <select id="id_is_public" name="is_public" 
                                                    class="glass-input w-full px-4 py-3 border-2 border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all hover:border-gray-400">
                                                <option value="true" {% if organization.is_public %}selected{% endif %}>üåê Public</option>
                                                <option value="false" {% if not organization.is_public %}selected{% endif %}>üîí Private</option>
                                            </select>
                                            <p class="text-xs text-gray-500 mt-2 flex items-start">
                                                <i class="fas fa-info-circle mr-2 mt-0.5 text-blue-500"></i>
                                                <span>Public organizations are open to all students. Private ones are limited to specific programs or invited members.</span>
                                            </p>
                                        </div>
                                    </div>

                                    <!-- Adviser -->
                                    <div class="border-gradient fade-in-up stagger-4">
                                        <label for="id_adviser" class="block text-sm font-semibold text-gray-700 mb-2 flex items-center">
                                            <i class="fas fa-user-tie text-blue-600 mr-2"></i>
                                            Adviser
                                        </label>
                                        <select id="id_adviser" name="adviser" 
                                                class="glass-input w-full px-4 py-3 border-2 border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all hover:border-gray-400">
                                            <option value="">Select Adviser</option>
                                            {% for user in users %}
                                            <option value="{{ user.id }}" {% if organization.adviser and organization.adviser.id == user.id %}selected{% endif %}>{{ user.last_name }}, {{ user.first_name }}</option>
                                            {% endfor %}
                                        </select>
                                        <p class="text-xs text-gray-500 mt-2 flex items-start">
                                            <i class="fas fa-info-circle mr-1 mt-0.5 text-blue-500"></i>
                                            <span>Select the organization adviser</span>
                                        </p>
                                    </div>

                                    <!-- Description -->
                                    <div class="border-gradient fade-in-up stagger-4">
                                        <label for="id_description" class="block text-sm font-semibold text-gray-700 mb-2 flex items-center">
                                            <i class="fas fa-align-left text-blue-600 mr-2"></i>
                                            About Organization
                                        </label>
                                        <textarea id="id_description" name="description" rows="5"
                                                  placeholder="Enter organization description"
                                                  class="glass-input w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all resize-none hover:border-gray-400">{{ organization.description }}</textarea>
                                        <p class="text-xs text-gray-500 mt-2 flex items-start">
                                            <i class="fas fa-info-circle mr-1 mt-0.5 text-blue-500"></i>
                                            <span>Provide a brief description of your organization</span>
                                        </p>
                                    </div>

                                    <!-- Programs Affiliated -->
                                    <div class="glass-card p-6 rounded-xl border border-blue-200 fade-in-up stagger-4">
                                        <div class="flex justify-between items-center mb-4">
                                            <label class="block text-sm font-semibold text-gray-700 flex items-center">
                                                <i class="fas fa-graduation-cap text-blue-600 mr-2"></i>
                                                Programs Affiliated
                                            </label>
                                            <button id="openProgramsModal" type="button"
                                                    class="bg-gradient-to-r from-blue-500 to-blue-600 text-white px-4 py-2 rounded-lg text-sm font-semibold hover:from-blue-600 hover:to-blue-700 transition-all shadow-md hover:shadow-lg flex items-center gap-2 shimmer-effect hover:scale-105">
                                                <i class="fas fa-plus-circle"></i>
                                                Select Programs
                                            </button>
                                        </div>

                                        <div id="displayChips"
                                             class="flex flex-wrap gap-3 p-4 border-2 border-dashed border-gray-300 rounded-lg bg-white min-h-[80px] transition-all hover:border-blue-400">
                                            {% if not organization.is_public %}
                                                {% for program in organization.allowed_programs.all %}
                                                    <span class="program-chip inline-flex items-center bg-gradient-to-r from-blue-100 to-blue-50 text-blue-800 px-3 py-2 rounded-full text-sm font-medium border border-blue-200 shadow-sm" data-id="{{ program.id }}">
                                                        <i class="fas fa-book mr-2 text-blue-600"></i>
                                                        <span>{{ program.name }}</span>
                                                        <button type="button" class="ml-3 text-blue-600 hover:text-blue-800 font-bold text-lg remove-chip transition-colors">√ó</button>
                                                    </span>
                                                {% endfor %}
                                            {% endif %}
                                        </div>
                                        <p class="text-xs text-gray-500 mt-3 flex items-start">
                                            <i class="fas fa-info-circle mr-2 mt-0.5 text-blue-500"></i>
                                            <span>Click "Select Programs" to add affiliated academic programs</span>
                                        </p>
                                    </div>

                                    <!-- Action Buttons -->
                                    <div class="flex flex-col sm:flex-row justify-end gap-3 pt-6 border-t-2 border-gray-200 fade-in-up stagger-4">
                                        <a href="{% url 'organization_profile' organization.id %}"
                                           class="px-6 py-3 border-2 border-gray-300 rounded-lg hover:bg-gray-50 transition-all inline-flex items-center justify-center font-medium text-gray-700 shadow-sm hover:shadow hover:scale-105">
                                            <i class="fas fa-times mr-2"></i> Cancel
                                        </a>

                                        <button type="submit" class="btn-primary px-6 py-3 text-white rounded-lg font-semibold shadow-lg inline-flex items-center justify-center gap-2">
                                            <i class="fas fa-save"></i>
                                            <span>Save Changes</span>
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    {% endif %}

    {% include 'organization/programs_affiliated_modal.html' %}

    {{ programs|json_script:"programs-data" }}
    
    <script id="current-programs-data" type="application/json">
    [
        {% if not organization.is_public %}
        {% for program in organization.allowed_programs.all %}
        "{{ program.id }}"{% if not forloop.last %},{% endif %}
        {% endfor %}
        {% endif %}
    ]
    </script>
    
    <script>
        const currentAllowedPrograms = JSON.parse(document.getElementById('current-programs-data').textContent);
        const programsData = JSON.parse(document.getElementById('programs-data').textContent);
    </script>

    <script src="{% static 'js/organization/func_editorgprofile.js' %}"></script>
    <script src="{% static 'js/organization/program_affiliated_modal.js' %}"></script>

    <!-- Mobile Menu JavaScript -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Mobile menu toggle
            const mobileMenuToggle = document.getElementById('mobileMenuToggle');
            const sidebar = document.querySelector('.sidebar');
            const overlay = document.getElementById('overlay');
            
            mobileMenuToggle?.addEventListener('click', () => {
                sidebar.classList.toggle('mobile-open');
                overlay.classList.toggle('hidden');
            });

            overlay?.addEventListener('click', () => {
                sidebar.classList.remove('mobile-open');
                overlay.classList.add('hidden');
            });

            // Mobile actions dropdown
            const mobileActionsBtn = document.getElementById('mobileActionsBtn');
            const mobileActionsMenu = document.getElementById('mobileActionsMenu');
            
            mobileActionsBtn?.addEventListener('click', (e) => {
                e.stopPropagation();
                mobileActionsMenu.classList.toggle('hidden');
            });

            // Close mobile actions menu when clicking outside
            document.addEventListener('click', (e) => {
                if (!mobileActionsBtn?.contains(e.target)) {
                    mobileActionsMenu?.classList.add('hidden');
                }
            });

            // Close sidebar when clicking on navigation links (mobile)
            const navLinks = sidebar?.querySelectorAll('a');
            navLinks?.forEach(link => {
                link.addEventListener('click', () => {
                    if (window.innerWidth < 768) {
                        sidebar.classList.remove('mobile-open');
                        overlay.classList.add('hidden');
                    }
                });
            });

            // Handle window resize
            window.addEventListener('resize', () => {
                if (window.innerWidth >= 768) {
                    sidebar.classList.remove('mobile-open');
                    overlay.classList.add('hidden');
                }
            });
        });
    </script>
</body>
</html>