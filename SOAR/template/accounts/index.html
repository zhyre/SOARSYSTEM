{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOAR - Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/organization/organization_page.css' %}">
    <style>
        * {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .sidebar {
            transition: transform 0.3s ease;
        }

        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                position: fixed;
                z-index: 50;
            }

            .sidebar.mobile-open {
                transform: translateX(0);
            }
        }

        /* Animated Gradient Background */
        .content-area {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            position: relative;
        }

        /* Stats Card Enhancements */
        .stat-card {
            position: relative;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(226, 232, 240, 0.8);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, transparent 0%, rgba(59, 130, 246, 0.03) 100%);
            opacity: 0;
            transition: opacity 0.4s ease;
        }

        .stat-card:hover::before {
            opacity: 1;
        }

        .stat-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow:
                0 20px 40px -10px rgba(59, 130, 246, 0.15),
                0 10px 20px -5px rgba(59, 130, 246, 0.1),
                0 0 0 1px rgba(59, 130, 246, 0.1);
            border-color: rgba(59, 130, 246, 0.3);
        }

        .stat-card-icon {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        .stat-card:hover .stat-card-icon {
            transform: scale(1.15) rotate(5deg);
            box-shadow: 0 8px 20px rgba(59, 130, 246, 0.4);
        }

        /* Icon Float Animation */
        @keyframes float {

            0%,
            100% {
                transform: translateY(0px);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        .stat-card-icon {
            animation: float 3s ease-in-out infinite;
        }

        .stat-card:nth-child(1) .stat-card-icon {
            animation-delay: 0s;
        }

        .stat-card:nth-child(2) .stat-card-icon {
            animation-delay: 0.5s;
        }

        .stat-card:nth-child(3) .stat-card-icon {
            animation-delay: 1s;
        }

        /* Number Counter */
        .stat-number {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Shimmer Effect */
        @keyframes shimmer {
            0% {
                background-position: -1000px 0;
            }

            100% {
                background-position: 1000px 0;
            }
        }

        .stat-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg,
                    transparent,
                    rgba(59, 130, 246, 0.1),
                    transparent);
            transition: left 0.7s;
        }

        .stat-card:hover::after {
            left: 100%;
        }

        /* Organization Card */
        .org-card {
            position: relative;
            background: white;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid #e5e7eb;
        }

        .org-card::before {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: inherit;
            padding: 2px;
            background: linear-gradient(135deg, transparent, rgba(59, 130, 246, 0.5), transparent);
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            mask-composite: exclude;
            mask-composite: xor;
            opacity: 0;
            transition: opacity 0.4s;
        }

        .org-card:hover {
            transform: translateY(-6px);
            box-shadow:
                0 20px 35px -10px rgba(59, 130, 246, 0.2),
                0 10px 20px -5px rgba(59, 130, 246, 0.15),
                0 0 0 1px rgba(59, 130, 246, 0.1);
            border-color: rgba(59, 130, 246, 0.3);
        }

        .org-card:hover::before {
            opacity: 1;
        }

        /* Fade In Animation */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fade-in {
            animation: fadeInUp 0.6s ease-out forwards;
            opacity: 0;
        }

        .animate-delay-1 {
            animation-delay: 0.1s;
        }

        .animate-delay-2 {
            animation-delay: 0.2s;
        }

        .animate-delay-3 {
            animation-delay: 0.3s;
        }

        .animate-delay-4 {
            animation-delay: 0.4s;
        }

        .animate-delay-5 {
            animation-delay: 0.5s;
        }

        /* Section Headers */
        .section-header {
            position: relative;
            padding-bottom: 16px;
        }

        .section-header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 60px;
            height: 4px;
            background: linear-gradient(90deg, #3b82f6, transparent);
            border-radius: 2px;
        }

        /* See More Button Enhancement */
        .btn-see-more {
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .btn-see-more::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn-see-more:hover::before {
            width: 300px;
            height: 300px;
        }

        /* Glow Effect */
        @keyframes glow {

            0%,
            100% {
                box-shadow: 0 0 20px rgba(59, 130, 246, 0.3);
            }

            50% {
                box-shadow: 0 0 30px rgba(59, 130, 246, 0.5);
            }
        }

        .stat-card:hover .stat-card-icon {
            animation: glow 2s ease-in-out infinite;
        }

        /* Event Cards */
        .event-card {
            transition: all 0.3s ease;
        }

        .event-card:hover {
            transform: translateX(8px);
            box-shadow:
                0 10px 25px -5px rgba(59, 130, 246, 0.15),
                0 5px 10px -5px rgba(59, 130, 246, 0.1);
            border-color: rgba(59, 130, 246, 0.3);
        }

        /* No Events State */
        .no-events {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            border: 2px dashed #cbd5e1;
        }

        /* Pulse Animation for Icons */
        @keyframes pulse-ring {
            0% {
                transform: scale(0.95);
                box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7);
            }

            70% {
                transform: scale(1);
                box-shadow: 0 0 0 10px rgba(59, 130, 246, 0);
            }

            100% {
                transform: scale(0.95);
                box-shadow: 0 0 0 0 rgba(59, 130, 246, 0);
            }
        }

        /* Smooth Scroll */
        .overflow-y-auto {
            scroll-behavior: smooth;
        }

        /* Custom Scrollbar */
        .overflow-y-auto::-webkit-scrollbar {
            width: 8px;
        }

        .overflow-y-auto::-webkit-scrollbar-track {
            background: #f1f5f9;
        }

        .overflow-y-auto::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }

        .overflow-y-auto::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
    </style>
</head>

<body class="bg-gray-50">
    <!-- Overlay for mobile -->
    <div id="overlay" class="hidden fixed inset-0 bg-black bg-opacity-50 z-40 md:hidden"></div>

    <div class="flex h-screen overflow-hidden">
        <!-- Sidebar -->
        {% include 'base/sidebar_components.html' with sidebar_type='dashboard' %}

        <!-- Main Content -->
        <main class="flex-1 flex flex-col overflow-hidden">
            <!-- Top Bar -->
            <header class="bg-white shadow-sm z-10">
                <div class="flex items-center justify-between px-6 py-4">
                    <div class="flex items-center space-x-4">
                        <div>
                            <h1 class="text-2xl font-bold text-gray-800">Welcome, {{ user.first_name|title }}{% if user.middle_name %} {{ user.middle_name|title }} {{ user.last_name|title }},{% endif %}!
                            </h1>
                        </div>
                    </div>
                    <!-- Right Side: Notification Bell + User Profile -->
                    <div class="flex items-center space-x-3">
                        <!-- Notification Bell -->
                        {% include 'base/notification_bell.html' %}

                        <div class="hidden md:block text-right">
                            <p class="text-sm font-medium text-gray-700">{{ user.last_name|title }}, {{ user.first_name|title }}{% if user.middle_name %} {{ user.middle_name|title }}{% endif %}</p>

                        </div>
                        <a href="{% url 'profile' %}">
                            {% if user.profile_picture %}
                            <img src="{{ user.profile_picture.url }}" alt="{{ user.last_name }}, {{ user.first_name }}"
                                class="w-10 h-10 rounded-full border-2 border-blue-500 cursor-pointer hover:border-blue-600 transition">
                            {% else %}
                            <img src="https://ui-avatars.com/api/?name={{ user.last_name }}+{{ user.first_name }}&background=2563eb&color=fff"
                                alt="{{ user.last_name }}, {{ user.first_name }}"
                                class="w-10 h-10 rounded-full border-2 border-blue-500 cursor-pointer hover:border-blue-600 transition">
                            {% endif %}
                        </a>
                    </div>
                </div>
            </header>

            <!-- Enhanced Content Area -->
            <div class="flex-1 overflow-y-auto p-6 content-area">
                <!-- Enhanced Stats Cards -->
                <div class="max-w-6xl mx-auto">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
                        <!-- Organizations Card -->
                        <div class="stat-card rounded-2xl p-7 cursor-pointer animate-fade-in animate-delay-1">
                            <div class="flex items-center justify-between">
                                <div class="flex-1">
                                    <p class="text-sm font-semibold text-gray-500 mb-2 uppercase tracking-wider">My
                                        Organizations</p>
                                    <h3 class="text-5xl font-bold stat-number mb-2" data-count="{{ user_orgs.count }}">0
                                    </h3>
                                    <p class="text-xs text-gray-500 font-medium">Active memberships</p>
                                </div>
                                <div
                                    class="stat-card-icon w-16 h-16 bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl flex items-center justify-center shadow-lg">
                                    <i class="fas fa-users text-white text-2xl"></i>
                                </div>
                            </div>
                        </div>

                        <!-- Events Card -->
                        <div class="stat-card rounded-2xl p-7 cursor-pointer animate-fade-in animate-delay-2">
                            <div class="flex items-center justify-between">
                                <div class="flex-1">
                                    <p class="text-sm font-semibold text-gray-500 mb-2 uppercase tracking-wider">Upcoming Events</p>
                                    <h3 class="text-5xl font-bold stat-number mb-2" data-count="{{ user_events|length|default_if_none:'0' }}">0</h3>
                                    <p class="text-xs text-gray-500 font-medium">Next 7 days</p>
                                </div>
                                <div
                                    class="stat-card-icon w-16 h-16 bg-gradient-to-br from-green-500 to-green-600 rounded-2xl flex items-center justify-center shadow-lg">
                                    <i class="fas fa-calendar-check text-white text-2xl"></i>
                                </div>
                            </div>
                        </div>

                        <!-- Available Organizations Card -->
                        <div class="stat-card rounded-2xl p-7 cursor-pointer animate-fade-in animate-delay-3">
                            <div class="flex items-center justify-between">
                                <div class="flex-1">
                                    <p class="text-sm font-semibold text-gray-500 mb-2 uppercase tracking-wider">
                                        Available Orgs</p>
                                    <h3 class="text-5xl font-bold stat-number mb-2" data-count="{{ total_available_orgs }}">0</h3>
                                    <p class="text-xs text-gray-500 font-medium">Total organizations</p>
                                </div>
                                <div
                                    class="stat-card-icon w-16 h-16 bg-gradient-to-br from-purple-500 to-purple-600 rounded-2xl flex items-center justify-center shadow-lg">
                                    <i class="fas fa-building text-white text-2xl"></i>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Enhanced My Organizations Section -->
                    <div class="mb-12 animate-fade-in animate-delay-4">
                        <div class="flex items-center justify-between mb-8">
                            <div class="section-header">
                                <h2 class="text-3xl font-bold text-gray-800 flex items-center gap-3">
                                    <div
                                        class="w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center">
                                        <i class="fas fa-building text-white text-lg"></i>
                                    </div>
                                    My Organizations
                                </h2>
                                <p class="text-gray-600 mt-3 ml-13">Click on an organization to view its dashboard</p>
                            </div>
                            {% if show_see_more %}
                            <a href="{% url 'organizations_page' %}"
                                class="btn-see-more group px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all flex items-center gap-2 shadow-lg hover:shadow-xl hover:scale-105 relative z-10">
                                <span class="relative z-10">See More</span>
                                <i
                                    class="fas fa-arrow-right group-hover:translate-x-1 transition-transform relative z-10"></i>
                            </a>
                            {% endif %}
                        </div>
                        <div class="animate-fade-in animate-delay-5">
                            {% include 'organization/normal_org_card.html' %}
                        </div>
                    </div>
                </div>

                <!-- Enhanced Upcoming Events Section -->
                <div class="max-w-6xl mx-auto animate-fade-in animate-delay-5">
                    <div class="flex items-center justify-between mb-8">
                        <div class="section-header">
                            <h2 class="text-3xl font-bold text-gray-800 flex items-center gap-3">
                                <div
                                    class="w-10 h-10 bg-gradient-to-br from-green-500 to-green-600 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-calendar-alt text-white text-lg"></i>
                                </div>
                                Upcoming Events
                            </h2>
                        </div>
                        {% if not user_events %}
                        <div class="flex items-center gap-2 text-gray-400">
                            <i class="fas fa-info-circle"></i>
                            <span class="text-sm font-medium">No upcoming events</span>
                        </div>
                        {% endif %}
                    </div>
                    <div class="space-y-4">
                        {% for event in user_events %}
                        <div class="event-card">
                            {% include 'event/event_activitycard.html' %}
                        </div>
                        {% empty %}
                        <div class="no-events rounded-2xl p-12 text-center">
                            <div
                                class="w-20 h-20 bg-gray-200 rounded-full flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-calendar-times text-gray-400 text-3xl"></i>
                            </div>
                            <p class="text-gray-500 text-lg font-medium">No upcoming events scheduled</p>
                            <p class="text-gray-400 text-sm mt-2">Check back later for new events</p>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Mobile menu toggle
        const mobileMenuToggle = document.getElementById('mobileMenuToggle');
        const sidebar = document.getElementById('sidebar');
        const overlay = document.getElementById('overlay');

        mobileMenuToggle?.addEventListener('click', () => {
            sidebar.classList.toggle('mobile-open');
            overlay.classList.toggle('hidden');
        });

        overlay?.addEventListener('click', () => {
            sidebar.classList.remove('mobile-open');
            overlay.classList.add('hidden');
        });

        // Counter Animation for Stats
        function animateCounter(element) {
            const target = parseInt(element.getAttribute('data-count'));
            const duration = 2000;
            const increment = target / (duration / 16);
            let current = 0;

            const updateCounter = () => {
                current += increment;
                if (current < target) {
                    element.textContent = Math.floor(current);
                    requestAnimationFrame(updateCounter);
                } else {
                    element.textContent = target;
                }
            };

            updateCounter();
        }

        // Trigger counter animation on page load
        document.addEventListener('DOMContentLoaded', () => {
            const counters = document.querySelectorAll('[data-count]');
            counters.forEach(counter => {
                setTimeout(() => animateCounter(counter), 500);
            });

            // Add stagger animation to organization cards
            const orgCards = document.querySelectorAll('.org-card');
            orgCards.forEach((card, index) => {
                card.style.animationDelay = `${0.6 + (index * 0.1)}s`;
                card.classList.add('animate-fade-in');
            });

            // Add observer for scroll animations
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('animate-fade-in');
                    }
                });
            }, { threshold: 0.1 });

            document.querySelectorAll('.event-card').forEach(card => {
                observer.observe(card);
            });
        });
    </script>
</body>

</html>